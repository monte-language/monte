#!/usr/bin/env python

import sys, os
path = os.path.abspath(sys.argv[0])
while os.path.dirname(path) != path:
    if os.path.exists(os.path.join(path, 'monte', '__init__.py')):
        sys.path.insert(0, path)
        break
    path = os.path.dirname(path)

import monte.runtime.load
# from monte.repl import startRepl

# startRepl()
from monte.runtime.scope import ioScope, safeScope
scope = safeScope.copy()
scope.update(ioScope)

from monte.runtime.vat import Vat, createVatScope

# XXX pass in a reactor when ready
vat = Vat(None)
createVatScope(vat, scope)

if len(sys.argv) > 1:
    monte.runtime.load.eval(source=open(sys.argv[1]).read(), scope=scope)
